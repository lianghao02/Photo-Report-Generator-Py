# 📸 蒐證照片報表產生器 (Photo Report Generator)

這是一個專為無需懂程式的使用者設計的 Python 工具，能夠快速將蒐證照片整理並產生標準化的 Word (.docx) 報表。

## ✨ 主要功能

*   **直覺操作**：拖放上傳照片，側邊欄拖曳調整順序 (自動重新編號)。
*   **智慧填寫**：
    *   **日期**：預設使用全域日期，保持空白即自動繼承。
    *   **地點/說明**：支援全域預設值，單張照片可單獨修改。
*   **雙模式排版**：
    *   **直式標準 (Vertical)**：每頁上下 2 張照片 (A4)。
    *   **雙欄對照 (Side-by-Side)**：每頁左右 2 張照片 (適合手機截圖)。
    *   *系統會依據您選擇的 Word 模板檔名自動切換模式。*
*   **防呆機制**：誤刪照片可透過「復原刪除」按鈕救回。
*   **完整保留**：縮圖採用 Letterbox (留白) 顯示，確保照片內容不被裁切。

---

## 🚀 快速開始 (Quick Start)

### 1. 環境需求
*   已安裝 **Python 3.8** 或以上版本。
*   已安裝相關套件 (初次使用請執行 `pip install -r requirements.txt`)。

### 2. 啟動程式
在資料夾中找到 **`Start.bat`**，滑鼠左鍵**點兩下**即可啟動。
*(程式會自動開啟瀏覽器視窗)*

---

## 📖 使用說明

### 步驟 1：側邊欄設定 (Global Settings)
在左側邊欄設定共用的資訊：
*   **案由**：報表標題與內容使用。
*   **地點/製作人**：全域預設值。
*   **日期**：報表日期 (若照片日期空白，將預設使用此日期)。
*   **全域說明**：若照片說明空白，預設使用此段文字。

### 步驟 2：選擇模板 (Template)
*   請確認 `assets/` 資料夾內有您的 `.docx` 模板。
*   **自動模式切換**：
    *   若模板檔名包含 **「左右」** (例如 `左右兩張.docx`) ➜ 切換為 **雙欄模式**。
    *   其他檔名 ➜ 切換為 **直式模式**。

### 步驟 3：上傳與編輯照片
1.  **上傳**：將照片拖拉至中間上傳區。
2.  **排序**：在左側邊欄的「📍 照片排序」區塊，拖曳項目來調整順序。
3.  **編輯資訊**：
    *   **日期/地點/說明**：預設為空白 (灰字提示會顯示將繼承的全域值)。
    *   若需修改，直接輸入內容即可覆蓋全域設定。

### 步驟 4：產生報表
點擊最下方的 **「🚀 生成 Word 報表」** 按鈕，即可下載整理好的 `.docx` 檔案。

---

## 📂 專案架構 (Project Structure)

```text
Photo-Report-Generator-Py/
├── Start.bat           # [啟動入口] 點兩下即可執行程式
├── requirements.txt    # [環境設定] Python 套件清單
├── README.md           # [說明文件] 本檔案
│
├── src/                # [核心代碼]
│   ├── app.py          # 主程式 (Streamlit UI 介面邏輯)
│   ├── generator.py    # Word 生成邏輯 (處理排版、取代佔位符)
│   └── utils.py        # 工具函式 (圖片處理、EXIF 讀取等)
│
└── assets/             # [資源庫]
    ├── 上下兩張.docx    # 直式模板範例
    └── 左右兩張.docx    # 雙欄模板範例
```

## 🛠️ 開發者資訊
*   **框架**：Streamlit
*   **影像處理**：Pillow (PIL)
*   **文件處理**：python-docx
*   **排序套件**：streamlit-sortables

---
> **注意**：本工具僅供內部使用，請確保模板檔案 (`.docx`) 的佔位符格式正確 (如 `[日期]`, `[圖片]` 等) 以避免生成錯誤。
